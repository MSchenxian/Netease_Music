{"version":3,"file":"static/js/971.e82654b7.js","mappings":"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","sources":["webpack://my_index/./src/views/SongList.vue?324a","webpack://my_index/src/views/SongList.vue","webpack://my_index/./src/views/SongList.vue?d278","webpack://my_index/./src/views/SongList.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"song-list\"},[(_vm.songdetails.length > 0)?_c('div',[_c('span',{staticClass:\"iconfont icon-fanhui\",on:{\"click\":function($event){$event.stopPropagation();return _vm.$router.back()}}}),_c('div',{staticClass:\"song-list-top\"},[_c('div',{staticClass:\"pic\",style:({ backgroundImage: (\"url(\" + (this.songdetail.coverImgUrl) + \")\") })}),_c('span',{staticClass:\"date\"},[_vm._v(\"更新日期:\"+_vm._s(_vm._f(\"datato\")(_vm.songdetail.updateTime)))])])]):_vm._e(),(_vm.songdetails.length < 1)?_c('load-animation',{staticClass:\"load-animation\"}):_c('music-item',{attrs:{\"musicitem\":_vm.showmore,\"currentmusic\":_vm.currentmusic,\"currentstate\":_vm.currentstate},on:{\"play\":function($event){return _vm.$emit('play',$event)}}}),(_vm.showmore.length > 0)?_c('div',{ref:\"loadmore\",staticClass:\"loadmore\",on:{\"click\":function($event){$event.stopPropagation();return _vm.more.apply(null, arguments)}}},[_vm._v(\" \"+_vm._s(_vm.pages >= _vm.pagesAll ? \"已经到底了...\" : \"点击加载更多...\")+\" \")]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"song-list\">\r\n    <div v-if=\"songdetails.length > 0\">\r\n      <span class=\"iconfont icon-fanhui\" @click.stop=\"$router.back()\"></span>\r\n      <div class=\"song-list-top\">\r\n        <div\r\n          class=\"pic\"\r\n          :style=\"{ backgroundImage: `url(${this.songdetail.coverImgUrl})` }\"\r\n        ></div>\r\n        <span class=\"date\">更新日期:{{ songdetail.updateTime | datato }}</span>\r\n      </div>\r\n    </div>\r\n    <load-animation\r\n      class=\"load-animation\"\r\n      v-if=\"songdetails.length < 1\"\r\n    ></load-animation>\r\n    <music-item :musicitem=\"showmore\" v-else\r\n      @play=\"$emit('play',$event)\"\r\n      :currentmusic=\"currentmusic\"\r\n      :currentstate=\"currentstate\"\r\n    ></music-item>\r\n    <div\r\n      v-if=\"showmore.length > 0\"\r\n      class=\"loadmore\"\r\n      ref=\"loadmore\"\r\n      @click.stop=\"more\"\r\n    >\r\n      {{ pages >= pagesAll ? \"已经到底了...\" : \"点击加载更多...\" }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport MusicItem from \"../components/MusicItem.vue\";\r\nexport default {\r\n  props:{\r\n    currentmusic:{\r\n      type:Object,\r\n      default:()=>{return null}\r\n    },\r\n    currentstate:{\r\n      type:Boolean,\r\n      default:true\r\n    }\r\n  },\r\n  components: { MusicItem },\r\n  data() {\r\n    return {\r\n      songdetail: [],\r\n      songdetails: [],\r\n      songdetailed: [],\r\n      pages: 1,\r\n    };\r\n  },\r\n  created() {\r\n    this.getPlayList();\r\n  },\r\n async mounted() {\r\n    await this.getPlayList();\r\n    // this.$refs.pic.style.backgroundImage = `url(${this.songdetail.coverImgUrl})`;\r\n     window.addEventListener(\"scroll\",this.scrollTop);\r\n  },\r\n  // beforeRouteLeave(to,from,next){\r\n  //    window.removeEventListener(\"scroll\",this.scrollTop);  \r\n  //    next();\r\n  // },\r\n  destroyed(){\r\n     window.removeEventListener(\"scroll\",this.scrollTop);  \r\n  },\r\n  methods: {\r\n    async getPlayList() {\r\n      const res = await this.axios.get(\r\n        \"/playlist/detail?id=\" + this.$route.query.id);\r\n      console.log(res);\r\n      this.songdetail = res.playlist;\r\n      this.songdetailed = res.privileges;\r\n\r\n      this.songdetails = res.playlist.tracks.map((item, index) => {\r\n        item.song = { \r\n          album: item.al,\r\n          alias: item.alia,\r\n          artists: item.ar,\r\n          i: index + 1 < 10 ? \"0\" + (index + 1) : index + 1,\r\n        };\r\n        return item;\r\n      });\r\n\r\n      this.songdetails.forEach((item, index) => {\r\n        if (item.id == this.songdetailed[index].id) {\r\n          return (item.song.privilege = {\r\n            maxbr: this.songdetailed[index].maxbr,\r\n          });\r\n        }\r\n      });\r\n    },\r\n    more() {\r\n      this.pages++;\r\n    },\r\n    scrollTop(){\r\n      // 滚动scroll,卷去的距离\r\n      let scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\r\n      // 加载更多...元素距离最顶部的距离\r\n      let loadmoreOffsetTop = this.$refs.loadmore.offsetTop;\r\n      // 可视化窗口高度\r\n      let clientHeight = window.innerHeight;\r\n      // console.log(\"卷去的距离scrollTop=>\",scrollTop,\"元素距离最顶部的距离loadmoreOffsetTop=>\",loadmoreOffsetTop,\r\n      // \"可视化窗口高度clientHeight=>\",clientHeight)\r\n      // 卷去的距离scrollTop=> 2137.60009765625 \r\n      // 元素距离最顶部的距离loadmoreOffsetTop=> 2765\r\n      // 可视化窗口高度clientHeight=> 667\r\n      // //判断触底 if(scrollTop + clientHeight >= loadmoreOffsetTop + 误差)\r\n      if(scrollTop + clientHeight >= loadmoreOffsetTop + 30){\r\n        this.pages++;\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    showmore() {\r\n      let end = this.pages * 20;\r\n      return this.songdetails.slice(0, end);\r\n    },\r\n    pagesAll() {\r\n      return this.songdetails.length / 20;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.song-list {\r\n  padding-bottom: 60px;\r\n  position: relative;\r\n  .icon-fanhui {\r\n    position: absolute;\r\n    top: 8px;\r\n    left: 10px;\r\n    font-size: 22px;\r\n    color: white;\r\n    z-index: 2;\r\n  }\r\n  .song-list-top {\r\n    width: 100vw;\r\n    height: 165px;\r\n    position: relative;\r\n    .pic {\r\n      height: 160px;\r\n      background-repeat: no-repeat;\r\n      background-size: cover;\r\n      background-position: center center;\r\n    }\r\n    .date {\r\n      color: white;\r\n      font-size: 12px;\r\n      position: absolute;\r\n      left: 4px;\r\n      bottom: 9px;\r\n    }\r\n  }\r\n  .load-animation {\r\n    padding-top: 20px;\r\n  }\r\n  .loadmore {\r\n    text-align: center;\r\n    height: 40px;\r\n    font-size: 14px;\r\n    line-height: 40px;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SongList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[0]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SongList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SongList.vue?vue&type=template&id=3a0eee6b&scoped=true&\"\nimport script from \"./SongList.vue?vue&type=script&lang=js&\"\nexport * from \"./SongList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SongList.vue?vue&type=style&index=0&id=3a0eee6b&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3a0eee6b\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","songdetails","length","on","$event","stopPropagation","$router","back","style","backgroundImage","songdetail","_v","_s","_f","updateTime","_e","attrs","showmore","currentmusic","currentstate","$emit","ref","more","apply","arguments","pages","pagesAll","staticRenderFns","props","type","default","components","MusicItem","data","songdetailed","created","getPlayList","window","destroyed","methods","async","res","axios","get","console","log","playlist","privileges","tracks","map","item","index","song","album","al","alias","alia","artists","ar","i","forEach","id","maxbr","scrollTop","document","documentElement","body","loadmoreOffsetTop","$refs","loadmore","offsetTop","clientHeight","innerHeight","computed","end","slice","component"],"sourceRoot":""}